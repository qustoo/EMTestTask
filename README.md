# Тестовое задание

<details>
<summary>Нажмите, чтобы раскрыть спойлер</summary>
Задание - https://docs.google.com/document/d/17qE_QawFOssdRIaEBzTaN8N-SYmkhh7tdNOy3ZTwHz8
</details>



## Описание задачи:
Необходимо разработать REST API с использованием FastAPI для управления библиотечным каталогом. API должно позволять работать с книгами, авторами и выдачей книг читателям.

## Основные требования:
Создание структуры базы данных:

### Использовать SQLAlchemy (2 версии) для взаимодействия с базой данных.
#### Спроектировать таблицы для следующих сущностей: 
- Author (Автор): id, имя, фамилия, дата рождения.
- Book (Книга): id, название, описание, id автора, количество доступных экземпляров.
- Borrow (Выдача): id, id книги, имя читателя, дата выдачи, дата возврата.

## Реализация REST API:
### Эндпоинты Автора:
1. Создание автора (POST /authors).
2. Получение списка авторов (GET /authors).
3. Получение информации об авторе по id (GET /authors/{id}).
4. Обновление информации об авторе (PUT /authors/{id}).
5. Удаление автора (DELETE /authors/{id}).
6. Эндпоинты для книг:
### Эндпоинты Книг:
1. Добавление книги (POST /books).
2. Получение списка книг (GET /books).
3. Получение информации о книге по id (GET /books/{id}).
4. Обновление информации о книге (PUT /books/{id}).
5. Удаление книги (DELETE /books/{id}).
### Эндпоинты для выдач:
1.  записи о выдаче книги (POST /borrows).
2. Получение списка всех выдач (GET /borrows).
3. Получение информации о выдаче по id (GET /borrows/{id}).
4. Завершение выдачи (PATCH /borrows/{id}/return) с указанием даты возврата.


## Реализовано:
- Написаны тесты на pytest, с созданием тестовой базой данных, и очисткой данных после тестов
- Проект контейнеризован при помощи Dockerfile(Buider,production ) и docker-compose(app, database)
- Использованы паттерны
  + UnitOfWork - управляет сессией, создавая и закрывая её, а также управляет репозиториями.
  + Repository - инкапсулирует бизнес-логику работы с конкретной сущностью в базе. 
  + Service - обрабатывает транзакции и управляет репозиториями.



## Запуск проекта в режиме локальной разработки

0. Создание виртуального окружения.
```python -m venv venv```

1. Установка необходимых зависимостей
```pip install -r requirements.txt```

3. Создать файл .env и заполнить его переменными окружения после чего переместить в /src
```cp .env /src```

4. Запуск контейнера с PostgreSQL ```docker compose -f docker-compose-local.yml --build up```

5. Запуск контейнера с Application, PostgreSQL ```docker compose -f docker-compose-start.yml --build up```

## Доступы следующие команды при помощи утилиты Make:
+ ***Поднять приложение***```make up```
+ ***Остановить приложение***```make up```
+ ***Собрать образ***```make build```
+ ***Посмотреть логи***```make logs```
+ ***Прогнать все линтеры***```make linters```
+ ***Удалить мусорные данные***```make clean``